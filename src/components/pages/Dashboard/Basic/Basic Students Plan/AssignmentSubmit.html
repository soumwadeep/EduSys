<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="https://edusys.co.in/icon.png" />
    <title>Submit Assignment | EduSys</title>
    <meta
      name="description"
      content="Welcome To India's Best Digital Education System"
    />
    <meta
      name="keywords"
      content="EduSys,Byjus,Aakash,Allen,Smart Class,Recorder Videos,Notes,Books,Cheap,Free,Online,Offline,India"
    />
    <meta name="author" content="Soumwadeep Guha" />

    <!-- Bootstrap 5.2 -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom Styling -->
    <style type="text/css">
      @import url("https://fonts.googleapis.com/css2?family=Sansita&display=swap");
      body {
        font-family: "Sansita", sans-serif;
        overflow-x: hidden;
      }
      .outer {
        display: table;
        height: 100%;
        width: 100%;
      }

      .middle {
        display: table-cell;
        vertical-align: middle;
      }

      .btn {
        border: 1px solid #f53803;
      }

      .btn:hover {
        background-color: #f53803;
        border-color: #f53803;
        color: white !important;
      }

      .inner {
        margin-left: auto;
        margin-right: auto;
        height: auto;
        width: 100%;
        /* max-width: 400px; */
      }

      span {
        color: #f53803;
      }

      .imgfix {
        width: 100%;
        height: auto;
      }

      #animateimg {
        animation: up-down 2s ease-in-out infinite alternate-reverse both;
      }

      @media screen and (max-width: 962px) {
        #mobviewtextfix h1 {
          font-size: 24px;
        }

        #mobviewtextfix h5 {
          font-size: 14px;
        }
      }

      @-webkit-keyframes up-down {
        0% {
          transform: translateY(10px);
        }

        100% {
          transform: translateY(-10px);
        }
      }

      @keyframes up-down {
        0% {
          transform: translateY(10px);
        }

        100% {
          transform: translateY(-10px);
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm">
          <div class="outer">
            <div class="middle">
              <div class="inner" id="mobviewtextfix">
                <h1>Assignment <span>Submission</span></h1>
                <h4>Here You Can Submit Your Assignments.</h4>
                <h4>
                  Please Use This Name Styling For Your File.If You Don't Follow
                  The Name Styling,Then Your Assignment Will Not Be Evaluated.
                </h4>
                <h4><span>Name Styling:</span> "yoursem_yourrollno.pdf"</h4>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm">
          <div class="outer">
            <div class="middle">
              <div class="inner" id="mobviewtextfix">
                <img
                  src="https://img.freepik.com/free-vector/businessman-holding-pencil-big-complete-checklist-with-tick-marks_1150-35019.jpg?w=1380&t=st=1664778512~exp=1664779112~hmac=f3c121c8187fac25e122cf947de37a888b04aa54c0df3dc20cb42e64e2245c2a"
                  alt="BasicSubmit"
                  class="imgfix"
                  id="animateimg"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <br />
      <!-- Form -->
      <form id="myForm">
        <div class="mb-3">
          <label class="form-label"><h4>Your Name</h4></label>
          <input type="text" name="myName" class="form-control" required />
        </div>
        <div class="mb-3">
          <label class="form-label"
            ><h4>Upload Your Assignment's Solution</h4></label
          >
          <input
            class="form-control form-control-lg"
            name="myFile"
            type="file"
            multiple
            required
          />
        </div>
        <button
          type="submit"
          value="Upload File"
          class="btn"
          required
          onclick="this.value='Uploading..';
                    google.script.run.withSuccessHandler(fileUploaded)
                    .uploadFiles(this.parentNode);
                    return false;"
        >
          <h4>Submit</h4>
        </button>
      </form>
      <div id="output"></div>
      <script>
        function fileUploaded(status) {
          document.getElementById("myForm").style.display = "none";
          document.getElementById("output").innerHTML = status;
        }
      </script>
    </div>
    <script>
      function doGet(e) {
        return HtmlService.createHtmlOutputFromFile(
          "form.html"
        ).setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
      }

      function uploadFiles(form) {
        try {
          var dropbox = "Assignment Submissions";
          var folder,
            folders = DriveApp.getFoldersByName(dropbox);

          if (folders.hasNext()) {
            folder = folders.next();
          } else {
            folder = DriveApp.createFolder(dropbox);
          }

          var blob = form.myFile;
          var file = folder.createFile(blob);
          file.setDescription("This File Is Uploaded By: " + form.myName);

          return "Your Assignment Has Been Submitted Successfully.";
        } catch (error) {
          return error.toString();
        }
      }
    </script>
  </body>
</html>
